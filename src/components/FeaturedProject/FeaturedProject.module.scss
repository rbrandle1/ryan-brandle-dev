@use '@/styles/utils/typography';
@use '@/styles/utils/viewport';
@use '@/styles/utils/element';

@use 'sass:math';

.component {
	--transition-duration-base: var(--duration-3xl);
	--transition-duration: calc(var(--transition-duration-base) - var(--transition-delay));
	--transition-distance: var(--space-md);
	--transition-delay: var(--duration-sm);
	--transition-ease: ease-in-out;

	position: relative;
	display: grid;
	grid-template-columns: 1fr;
	gap: 1lh;

	@include viewport.breakpoint(sm) {
		grid-template-columns: 1fr 1fr;
		gap: var(--gutter);
	}

	@include viewport.breakpoint(lg) {
		gap: 2lh;
	}
}

@media not (prefers-reduced-motion: reduce) {
	.imageContainer,
	.textContainer {
		transform: translateY(var(--transition-distance));
		opacity: 0;
		will-change: opacity, transform;
		transition: opacity var(--transition-duration) var(--transition-ease),
			transform var(--transition-duration) var(--transition-ease);

		.fadeInUp & {
			opacity: 1;
			transform: translateY(0);
		}
	}
}

.imageContainer {
	position: relative;

	@include viewport.breakpoint(sm) {
		margin-block-start: 2lh;
		transition-delay: var(--transition-delay);

		.imgRight & {
			order: 2;
		}
	}
}

.textContainer {
	--flow-space: 1lh;

	--transition-distance: var(--space-lg);
	--transition-duration: var(--transition-duration-base);

	> * + * {
		margin-block-start: var(--flow-space);
	}
}

.cropIconContainer {
	position: absolute;
	width: var(--text-lg);

	&:not(.imgRight &) {
		left: calc(var(--space-lg) / -1);
	}

	.imgRight & {
		right: calc(var(--space-lg) / -1);
	}

	svg {
		fill: currentColor;
		opacity: 0.1;
	}
}

.image {
	position: relative;
	display: grid;
	place-items: center;
	padding-inline: var(--space-xl);
	border-radius: var(--radius-default);
	background-color: var(--surface-neutral);
	aspect-ratio: 3 / 2;
	overflow: hidden;
	user-select: none;

	@include viewport.breakpoint(sm) {
		aspect-ratio: 2 / 3;
	}

	img {
		object-fit: cover;

		@media not (prefers-reduced-motion: reduce) {
			transition: transform var(--duration-2xl) ease-out;

			@include viewport.has-hover {
				transform: scale(1.02);
			}
		}
	}
}

.logoContainer {
	width: 100%;
	max-width: 338px;
	pointer-events: none;
	z-index: 1;

	svg {
		fill: var(--icon-over-image);
		filter: var(--shadow-svg);
	}
}

.title {
	@include typography.headline;
	max-width: var(--optimal-line-length-xs);
	margin-block-end: 0.125lh;

	@include viewport.breakpoint(sm) {
		max-width: var(--optimal-line-length-2xs);
	}
}

.description {
	max-width: var(--optimal-line-length-base);
}

.buttonWrapper {
	--distance: 7px;
	--shadow-color: var(--button-border);
	--button-speed: var(--duration-md);

	position: relative;
	display: inline-block;

	&:active {
		transform: var(--button-press);
	}
}

.button {
	position: relative;
	appearance: none;
	display: inline-flex;
	justify-content: center;
	align-items: center;
	font-optical-sizing: auto;
	font-weight: var(--font-weight-bold);
	font-style: normal;
	font-size: var(--text-base);
	text-transform: uppercase;
	border: none;
	color: var(--button-foreground); //todo, can surface-primary be used here?
	background-color: var(--button-background);
	padding: var(--button-spacing);
	cursor: pointer;
	z-index: 2;
	transition: background-color var(--button-speed) ease-out, color var(--button-speed) ease-out;

	@include viewport.has-hover(':hover', ':focus-visible') {
		background-color: var(--button-background-hover);
		color: var(--button-foreground-hover);

		~ .buttonShadow {
			transform: translate(0, 0);

			&.bottomLeft::before,
			&.bottomLeft::after,
			&.topRight::before,
			&.topRight::after {
				transform: scale(0);
			}
		}
	}
}

.buttonShadow {
	position: absolute;
	inset: 0;
	background-color: var(--button-border);
	transition: transform var(--button-speed) ease-out;
	z-index: 1;

	&.bottomLeft,
	&.topRight {
		&::before,
		&::after {
			position: absolute;
			content: '';
			width: 0;
			height: 0;
			border: var(--distance) solid transparent;
			transition: opacity var(--button-speed) ease-out, transform var(--button-speed) ease-out;
		}

		&::before {
			border-right: var(--distance) solid var(--button-border);
			border-left-width: 0;
			right: 100%;
		}

		&::after {
			border-left: var(--distance) solid var(--button-border);
			border-top-width: 0;
		}
	}

	&.bottomLeft {
		transform: translate(calc(var(--distance) * -1), var(--distance));

		&::before {
			top: calc(var(--distance) / -1);
			right: calc(100% - var(--distance));
			transform-origin: 0 50%;
		}

		&::after {
			left: 100%;
			bottom: 0;
			transform-origin: 0 100%;
		}
	}

	&.topRight {
		transform: translate(var(--distance), calc(var(--distance) * -1));

		&::before {
			top: 0;
			transform-origin: 100% 0;
		}

		&::after {
			left: calc(100% - var(--distance));
			bottom: calc(var(--distance) / -1);
			transform-origin: 50% 0;
		}
	}
}
